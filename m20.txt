M20 Release Notes
Milestone M20
Released on 29-September-2023

For a complete overview of the issues and merge requests, please refer here.

For detailed services that are included in this release, please refer to M20 tagging notes.

❗ Important Note
Sandbox/Incubator
Project status: https://osdu.projects.opengroup.org/pmc/work-products/pmc-portal/pmc-policies/main/maturity/maturity-list.html

In keeping with our policy of releasing new capabilities early and often for feedback, we are pleased to introduce several new Sandbox/Incubator platform capabilities in this milestone release. These are currently only available in specific cloud service providers with limited scopes and functionalities, future milestone releases will include more CSP support. Please refer to the details below.

Policy service - AWS, Azure, GC, IBM
External Data Services - Azure, GC, AWS
Geospatial Consumption Zone - Azure
Manifest ingestion by reference - GC, AWS, Azure
Rock and Fluid Sample DDMS - Azure
Energistics Parsers - Azure
For the evaluation metrics - please refer to the guide here

Deprecation Notice
We are now actively engaged in the process of integrating the functionalities of the File and Dataset services. It is important to note that, going forward, our primary focus will be on enhancing and prioritizing the capabilities of the Dataset service in the domain of file/dataset delivery. As of the present, both services remain accessible and operational. Further elaboration on this matter will be communicated in due course.
Table of Content
Milestone M20
❗ Important Note
Sandbox/Incubator
Deprecation Notice
Table of Content
New Features
Data Definition
M20 (v0.23.0) Additions
M21 (v0.24.0) M22 (v0.25.0) Change Warning
Core and Helper Services
Ingestion services
DDMS
External Data Services (EDS)
Bug Fixes
Core and Helper Services
Ingestion services
DDMS
External Data Services (EDS)
Enhancements
Core and Helper Services
Ingestion services
DDMS
Known Issues/Gaps
Supporting Information
New Features
Data Definition
M20 (v0.23.0) Additions
Generic Domain
New osdu:wks:master-data--UserProfile:1.0.0 taking the existing AbstractContact further, enabling standalone records, which can be reused and referred by other objects.
Updated osdu:wks:master-data--Basin:1.2.0 to include EffectiveDate and TerminationDate like all the other master-data entities participating in AbstractGeoContext.
New osdu:wks:dataset--PhysicalMedia:1.0.0 representing content, which is not (yet) available in digital form. Intended to be used as placeholders for on-demand retrieval from StorageFacility. More details in the Schema Usage Guide.
Seismic Domain
The dataset--FileCollection.SEGY:1.2.0 has been updated to include the AbstractVectorHeaderMapping:1.1.0 containing header value override instructions. An additional Boolean flag Is3D has been added to ease the parser's decision, which header locations to inspect. A relationship to StorageFacility allows references to physical storage of e.g. tapes and their tape and box labels. All changes are summarised in the migration guide
Well Delivery Domain
The osdu:wks:master-data--PlannedCementJob:1.2.0 is now followed by an actual CementJob osdu:wks:work-product-component--CementJob:1.0.0.
CementJob refers to 33 new reference value lists specific to cementing. Details in the ChangeReport.
Stratigraphy, Biostratigraphy, Fossils
ChronoStratigraphy - to be able to keep multiple schemes in parallel, a new
osdu:wks:reference-data--ChronoStratigraphicScheme:1.0.0 has been added with populated reference values for well-known schemes. New schema versions now refer to ChronoStratigraphicScheme for
osdu:wks:reference-data--ChronoStratigraphy:1.1.0, and
osdu:wks:reference-data--StratigraphicColumnRankUnitType:1.1.0.
New reference value lists in support of Biostratigraphy:
osdu:wks:reference-data--BiostratigraphicCountMethods:1.0.0
osdu:wks:reference-data--BiostratigraphicDiscipline:1.0.0
osdu:wks:reference-data--BiostratigraphicEventType:1.0.0
osdu:wks:reference-data--Biozone:1.0.0
osdu:wks:reference-data--FossilPreservation:1.0.0
osdu:wks:reference-data--FossilRecovery:1.0.0
Reference Values
External Data Services
osdu:wks:reference-data--ParentMatchingRuleSets:1.1.0 is extended with definitions how attribute values are to be replaced during successful matches. The example reference values are updated.
AliasNameType was extended by an External Data Services specific value EDSConnectedSourceIdentifier.
A new value set for ResourceLifecycleStatus with recommended usage described in the Schema Usage Guide.
M21 (v0.24.0) M22 (v0.25.0) Change Warning
OSDU uses group-type classifications for the entities. The definitions for the group-types are provided in the Schema Usage Guide. Over time some of the entities' group-type classifications have been challenged. The following types appear in the wrong group-type:

Reports are seen as non-tangible state descriptions/snapshots
master-data--FluidsReport proposed migrated to → work-product-component--WellFluidsReport.
master-data--OperationsReport proposed migrated to → work-product-component--WellOperationsReport.
Tubulars - when exchanged they are often transported using datasets/files, but the data themselves are tangible and associated with an investment making them master-data.
work-product-component--TubularAssembly proposed migrated to → master-data--TubularAssembly.
work-product-component--TubularComponent proposed migrated to → master-data--TubularComponent.
work-product-component--TubularExternalComponent proposed migrated to → master-data--TubularExternalComponent.
Obviously, this will impact operators who have ingested a large number of such data/records. This advance notice is intended to prepare for this change and/or engage with data definitions, specifically the Well Delivery work-stream, to influence the implementation of the change.

There is a schema preview including documentation provided in the Data Definitions community mirror.

Update 2023-09-26: the migration is postponed until M22 (v0.25.0).

Core and Helper Services
Search
Exclude system/metadata indices in searches with wildcard kind. See MR !543 by (@zhibinmai)
Added nested filter argument in sort. See ADR 106 and See MR !535 by (@sbstan)
Added highlight full text search fields: See ADR 128 and MR !226 and MR !541 by (@sbstan)
Schema
Resolve "OSDU-DD-Delivery-M20 (v0.23.0)". See MR !537 by (@gehrmann)
OS Core Common
Allow selection of highlighted fields. See MR !226 by (@sbstan)
Add filter to SortQuery search model. See MR !223 by (@sbstan)
Policy
Initial commit in multi-partition support. See MR !403 by (@hutchins)
Ingestion services
osdu-airflow-lib
M20 parent data mapping. See MR !142 by (@jeyakumar-jk)
Eds m20 Fixes. See MR !79 by (@priyankabhongade)
DDMS
RAFS (Rock and Fluid sample) DDMS
Expansion of analysis types supported (wiki for details)
Started the adoption of the "unified sample model" and new v2 endpoints (wiki for details)
Reservoir DDMS
Additional discovery feature: graph search, search of deleted entities. See MR [!166] osdu/platform/domain-data-mgmt-services/reservoir/open-etp-server!166 (merged) by @deny
Add /info end-point. See MR [!185] osdu/platform/domain-data-mgmt-services/reservoir/open-etp-server!185 (merged) by @deny
Seismic DDMS
seismic-dms-service
Feat: ls as post. See MR !831 by (@DiegoMolteni)
Feat: implemented query parameters in list dataset endpoint. See MR !674 by (@gbaramidze)
Wellbore DDMS
Wellbore Domain Services
Enable write operation using worker service. See MR !774 by (@Vernet)
External Data Services (EDS)
Parent data mapping - Scenario 3
Fetch-and-Ingest - logic for handling company name (Organisation Master data)
Naturalizing the external bulk data into internal
EDS - Logic to handle different types of dataset Schema in WPC records Datasets block fetched from Data Provider
Refactoring EDS Codebase for Robustness and SOLID Principles (Technical Debt)
Enhancing EDS DMS for Bulk Data Retrieval and Including Additional Fields for Order Placement
Bug Fixes
Core and Helper Services
Search
Switch tests to common and updated sort model. See MR !550 by (@Rustam_Lotsmanenko)
Storage
Fix issue with records batch api as it drops valid record after conversion. See MR !742 by (@nthakur)
Fix acl duplicates. See MR !739 by (@ajoshi19)
Indexer
Fix normalizedKind tag index bug. See MR !621 by (@mzhu9)
Ibm issue fix. See MR !616 by (@ashwani_pandey)
Updated schema cache name (7657). See MR !607 by (@Yurii_Ruban)
Make sure that the indexing message sent to Azure service bus is not over-size. See MR !597 by (@zhibinmai)
Indexer Queue
Re-index API logs are not correlated. See MR !344 by (@LPereira14)
File
Preserve non-standard filename(GONRG-7593). See MR !502 by (@Rustam_Lotsmanenko)
Notification
Fix NPE during delivery. See MR !432 by (@Rustam_Lotsmanenko)
Fixed getting subscription. See MR !420 by (@Yurii_Ruban)
Unit
Fix security filter for api docs(GONRG-7592). See MR !294 by (@Rustam_Lotsmanenko)
CRS Catalog
Added exclusion to security filter for apidocs endpoint(GONRG-7592). See MR !299 by (@Rustam_Lotsmanenko)
CRS Conversion
Resolve "unitDLS returns incorrect PR string when unitMD is passed as m for v4/convertTrajectory input request.". See MR !360 by (@puneet.bhardwaj)
Fix security filter for api docs(GONRG-7592). See MR !352 by (@Rustam_Lotsmanenko)
Resolve "bug convertTrajectory dls NaN for last point". See MR !349 by (@kiranallamsety)
OS Core Common
Fix redis ttl client responce (GONRG-7597). See MR !232 by (@Yurii_Ruban)
Added check redis connection (GONRG-7597). See MR !225 by (@Yurii_Ruban)
Remove duplicates from ACLs. See MR !222 by (@ajoshi19)
Entitlements
Fix import conflicts after last not synced merge. See MR !538 by (@Rustam_Lotsmanenko)
Update entitlements-changed topic name. See MR !537 by (@aotgonbold)
Policy
Bugfix Translate API Deny only rule. See MR !400 by (@srabanaguha)
Performance bug fix memory leak. See MR !403 (@hutchins)
Bugfix for development MOCK_ENTITLEMENT
Bugfix for /config API not reporting all configuration details
Bugfix conf USER_PERMISSION update
For more details on bug fixes in M20 see policy release notes
Ingestion services
osdu-airflow-lib
Feature m20 wpc handle all dataset priyanka. See MR !152 by (@priyankabhongade)
M20 parent data mapping. See MR !148 by (@jeyakumar-jk)
osdu-ingestion-lib
Update setup.py for supporting older versions of Airflow. See MR !66 by (@Yan_Sushchynski)
Fixed file-source. See MR !63 by (@deepapathak)
Fix: Read Segy SD Path from combining the FileSource and FileCollectionPath from initial record.. See MR !61 by (@deepapathak)
DDMS
Reservoir DDMS

Fix: missing entitlement validation for some requests See MR [!180] osdu/platform/domain-data-mgmt-services/reservoir/open-etp-server!180 (merged) by @deny
Fix: ETP SSL client - support of wellcard in delete all dataspace See MR [!173] osdu/platform/domain-data-mgmt-services/reservoir/open-etp-server!173 (merged) @deny
Fix: delete data object returned information See MR [!171] osdu/platform/domain-data-mgmt-services/reservoir/open-etp-server!171 (merged) @PavelKisliak
Fix: crash when wrong environment information provided See MR [!207] osdu/platform/domain-data-mgmt-services/reservoir/open-etp-server!207 (merged) @frivera
Seismic DDMS

seismic-dms-service
Fix: only scan the AWS folder for AWS secrets. See MR !873 by (@Konstantin)
Fix: fixed delete after list + list condition. See MR !868 by (@DiegoMolteni)
Fix: enabled redis key events. See MR !842 by (@DiegoMolteni)
Fix: change correlation-id name from underscore to hyphen. See MR !820 by (@mwang34)
Fix: fixes an issue where utility/ls ignores case in Azure. See MR !810 by (@mwang34)
seismic-dms-sdutil
Fix: fixes an issue where 'ls' may return "string index out of range". See MR !102 by (@mwang34)
External Data Services (EDS)
Versal Spatial Data Ingestion (While Ingesting the data, getting Spatial Coordinate block as Empty)
Enhancements
Core and Helper Services
Storage
Forward Entitlements Exception Message. See MR !743 by (@hamdaankhalid)
Migration to JDK 17 (GONRG-7527). See MR !740 by (@Stanislav_Riabokon)
Search
JDK 17 migration (GONRG-7477). See MR !532 by (@Yurii_Ruban)
Indexer
JDK 17 migration (GONRG-7477). See MR !589 by (@Yurii_Ruban)
Enhance logging to include correlation-id and record-id. See MR !587 by (@LPereira14)
Schema
JDK 17 migration. See MR !526 by (@cailletg)
Partition
JDK 17 Migration. See MR !412 by (@thulasi_dass)
Dataset
Dk/az dk revoke api. See MR !370 by (@deepapathak)
Add optional expiry time to control the signed urls. See MR !368 by (@deepapathak)
File
Add optional expiry time to control the signed urls. See MR !500 by (@deepapathak)
OS Core Common
Added dataset admin role. See MR !229 by (@deepapathak)
Adding expiry time for File DMS Security Enhancement. See MR !224 by (@deepapathak)
Unit
Optimized Swagger UI API Versions Order to Encourage Adoption of Latest APIs. See MR !295 by (@jayeshbagul)
CRS Catalog
Optimized Swagger UI API Versions Order to Encourage Adoption of Latest APIs. See MR !298 by (@jayeshbagul)
CRS Conversion
Added info endpoint to show apache sis version. See MR !353 by (@bhuwanupadhyay)
Latest V4 Endpoint Covered with Swagger and Optimized Swagger UI API Versions Order to Encourage Adoption of Latest APIs. See MR !351 by (@jayeshbagul)
Resolve "convertTrajectory enhancements Add an input argument "unitMD" to separate it from "unitZ".". See MR !345 by (@kiranallamsety)
Entitlements
Forward Reason For 403 when data partition is Invalid in AuthFilter. See MR !530 by (@hamdaankhalid)
Reduce cache IOPS. See MR !529 by (@Rustam_Lotsmanenko)
JDK 17 Migration. See MR !527 by (@thulasi_dass)
Added impersonation flow for get groups. See MR !498 by (@Rustam_Lotsmanenko)
Secret
OpenAPI 3.0 Documentation using springdoc. See MR !100 by (@jayeshbagul)
Secret JDK 17 migration. See MR !97 by (@lchas)
Policy
New experimental /tenant API for retrieving and updating data partition configuration details for OPA. These APIs will be enhanced in future milestones.
Added option in Translate API to construct elastic search subquery in search rego policy.
Added new response header X-Process-Time to all API call responses from policy service.
New diagnostic API /diag/tracker for checking object changes in memory over time (memory leak detection).
Optimized Swagger UI API Versions Order to Encourage Adoption of Latest APIs - including OpenAPI 3.1.0, JSON Schema 2020-12, Swagger UI version 5.x.x
ENV details can not be masked/unmasked in /config API response via env variable MASK_CONFIG_ENV
Cache settings can now be tweaked by environment variables to the policy service
For more information on new features, see Policy Service release notes
Ingestion services
Ingestion Workflow
OpenAPI 3.0 Documentation using springdoc. See MR !462 by (@jayeshbagul)
DDMS
Wellbore DDMS

Wellbore Domain Services
Dask local cluster not created if bulk management on worker service. See MR !775 by (@Vernet)
Reservoir DDMS

Reservoir Domain Services
Feat: Unification of login @PavelKisliak
Feat: Use of configuration file instead of environment variables. See MR [!196] osdu/platform/domain-data-mgmt-services/reservoir/open-etp-server!196 (merged) @gmartins
Seismic DDMS

seismic-dms-service
Feat: use optimised CosmosDB queries to retrieve subfolders. See MR !860 by (@iza)
Fix: ls accept minus 1 on pagination requests. See MR !855 by (@DiegoMolteni)
Feat: enable impersonation token caching in refresh. See MR !849 by (@mwang34)
Feat: Azure CosmosDB sidecar - update QueryRequestOptions. See MR !843 by (@iza)
Feat: use optimised CosmosDB queries to retrieve datasets. See MR !840 by (@iza)
Fix: added shared cache layer. See MR !827 by (@DiegoMolteni)
Fix: removed query-path and not used endpoints from sidecar. See MR !824 by (@DiegoMolteni)
Feat: enabled logging capabilities via Azure insights. See MR !817 by (@DiegoMolteni)
Fix: enabled SP credentials generation via Azure AD workload identity. See MR !816 by (@DiegoMolteni)
Known Issues/Gaps
Refer here for a list of known pre-shipping testing issues.

Due to the limitation on resources, thorough testing was only conducted on Azure, AWS, GC and RI environments. For full scope - please refer here

Supporting Information
Data Loading Guide. See here
Preship team's test results (documented steps). See here
Postman collections from QA aka "Platform Validation" team. See here
JSON payload and related information for loading sample data from TNO, Volve, NOPIMS. See here